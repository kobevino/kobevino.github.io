3:I[6731,[],""]
5:I[2923,[],""]
6:I[5403,["2","static/chunks/2-ad9c083589494568.js","979","static/chunks/979-9f1e3dabf5b88387.js","34","static/chunks/34-00f8cbeb68282840.js","185","static/chunks/app/layout-75c372431f7ce25f.js"],"ColorSchemeScript"]
7:I[9420,["2","static/chunks/2-ad9c083589494568.js","979","static/chunks/979-9f1e3dabf5b88387.js","34","static/chunks/34-00f8cbeb68282840.js","185","static/chunks/app/layout-75c372431f7ce25f.js"],"MantineProvider"]
8:I[7513,["2","static/chunks/2-ad9c083589494568.js","979","static/chunks/979-9f1e3dabf5b88387.js","34","static/chunks/34-00f8cbeb68282840.js","185","static/chunks/app/layout-75c372431f7ce25f.js"],"Header"]
9:I[863,["2","static/chunks/2-ad9c083589494568.js","979","static/chunks/979-9f1e3dabf5b88387.js","34","static/chunks/34-00f8cbeb68282840.js","185","static/chunks/app/layout-75c372431f7ce25f.js"],"Container"]
b:I[7792,["2","static/chunks/2-ad9c083589494568.js","42","static/chunks/app/%5Bslug%5D/page-cdea868390d0022c.js"],"Title"]
c:I[8002,["2","static/chunks/2-ad9c083589494568.js","42","static/chunks/app/%5Bslug%5D/page-cdea868390d0022c.js"],"Text"]
4:["slug","micro-frontend-with-s3","d"]
a:T53f,M62.6 142c-2.133 0-3.2-1.067-3.2-3.2V118h-56c-2 0-3-1-3-3V92.8c0-1.333.4-2.733 1.2-4.2L58.2 4c.8-1.333 2.067-2 3.8-2h28c2 0 3 1 3 3v85.4h11.2c.933 0 1.733.333 2.4 1 .667.533 1 1.267 1 2.2v21.2c0 .933-.333 1.733-1 2.4-.667.533-1.467.8-2.4.8H93v20.8c0 2.133-1.067 3.2-3.2 3.2H62.6zM33 90.4h26.4V51.2L33 90.4zM181.67 144.6c-7.333 0-14.333-1.333-21-4-6.666-2.667-12.866-6.733-18.6-12.2-5.733-5.467-10.266-13-13.6-22.6-3.333-9.6-5-20.667-5-33.2 0-12.533 1.667-23.6 5-33.2 3.334-9.6 7.867-17.133 13.6-22.6 5.734-5.467 11.934-9.533 18.6-12.2 6.667-2.8 13.667-4.2 21-4.2 7.467 0 14.534 1.4 21.2 4.2 6.667 2.667 12.8 6.733 18.4 12.2 5.734 5.467 10.267 13 13.6 22.6 3.334 9.6 5 20.667 5 33.2 0 12.533-1.666 23.6-5 33.2-3.333 9.6-7.866 17.133-13.6 22.6-5.6 5.467-11.733 9.533-18.4 12.2-6.666 2.667-13.733 4-21.2 4zm0-31c9.067 0 15.6-3.733 19.6-11.2 4.134-7.6 6.2-17.533 6.2-29.8s-2.066-22.2-6.2-29.8c-4.133-7.6-10.666-11.4-19.6-11.4-8.933 0-15.466 3.8-19.6 11.4-4 7.6-6 17.533-6 29.8s2 22.2 6 29.8c4.134 7.467 10.667 11.2 19.6 11.2zM316.116 142c-2.134 0-3.2-1.067-3.2-3.2V118h-56c-2 0-3-1-3-3V92.8c0-1.333.4-2.733 1.2-4.2l56.6-84.6c.8-1.333 2.066-2 3.8-2h28c2 0 3 1 3 3v85.4h11.2c.933 0 1.733.333 2.4 1 .666.533 1 1.267 1 2.2v21.2c0 .933-.334 1.733-1 2.4-.667.533-1.467.8-2.4.8h-11.2v20.8c0 2.133-1.067 3.2-3.2 3.2h-27.2zm-29.6-51.6h26.4V51.2l-26.4 39.2z0:["8cWx1zt8WLhtEFIRkePKt",[[["",{"children":[["slug","micro-frontend-with-s3","d"],{"children":["__PAGE__?{\"slug\":\"micro-frontend-with-s3\"}",{}]}]},"$undefined","$undefined",true],["",{"children":[["slug","micro-frontend-with-s3","d"],{"children":["__PAGE__",{},[["$L1","$L2"],null],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"./_next/static/css/4c62bdaf9ccfa79d.css","precedence":"next","crossOrigin":"$undefined"}]]}],null]},[["$","html",null,{"lang":"en","children":[["$","head",null,{"children":["$","$L6",null,{"defaultColorScheme":"auto"}]}],["$","body",null,{"children":["$","$L7",null,{"theme":{"cursorType":"pointer"},"defaultColorScheme":"auto","children":[["$","$L8",null,{}],["$","$L9",null,{"mt":100,"children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","$L9",null,{"className":"not-found_root___8tHH","children":["$","div",null,{"className":"not-found_inner__jk2We","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 362 145","className":"not-found_image__klXiS","children":[["$","title",null,{"children":"404"}],["$","path",null,{"fill":"currentColor","d":"$a"}]]}],["$","div",null,{"className":"not-found_content__cklTM","children":[["$","$Lb",null,{"className":"not-found_title__bOfUG","children":"Nothing to see here"}],["$","$Lc",null,{"c":"dimmed","size":"lg","ta":"center","className":"not-found_description__7RPJl","children":"Page you are trying to open does not exist. You may have mistyped the address, or the page has been moved to another URL. If you think this is an error contact support."}]]}]]}]}],"notFoundStyles":[["$","link","0",{"rel":"stylesheet","href":"./_next/static/css/9b82fbf9d3dab81a.css","precedence":"next","crossOrigin":"$undefined"}]],"styles":null}]}]]}]}]]}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"./_next/static/css/dbb50fd420b33798.css","precedence":"next","crossOrigin":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"./_next/static/css/1b43b2959fdf142d.css","precedence":"next","crossOrigin":"$undefined"}]],[null,"$Ld"]]]]]
d:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Kobe's Blog"}],["$","meta","3",{"name":"description","content":"Generated by Jaesung Lee"}],["$","link","4",{"rel":"icon","href":"/favicon.ico"}]]
1:null
e:I[5287,["2","static/chunks/2-ad9c083589494568.js","42","static/chunks/app/%5Bslug%5D/page-cdea868390d0022c.js"],"Stack"]
f:I[9231,["2","static/chunks/2-ad9c083589494568.js","42","static/chunks/app/%5Bslug%5D/page-cdea868390d0022c.js"],"Group"]
11:I[3179,["2","static/chunks/2-ad9c083589494568.js","42","static/chunks/app/%5Bslug%5D/page-cdea868390d0022c.js"],"Comments"]
10:Tb2ad,<p>Since I moved to new company, I've been responsible for designing the architecture for a new project.</p>
<h2>Micro-Frontend Architecture</h2>
<p><em>The things the team manager asked me for</em></p>
<ol>
<li>The legacy project, which is built on a monolithic architecture, had tons of issues. The two major issues we faced were long build times and severe side effects.</li>
<li>Very limited communication with the infrastructure team.</li>
<li>Lack of diverse hands-on experience for junior developers</li>
</ol>
<p>So, I studied a lot about <code>Micro Frontend Architecture</code> at that time. As a result, below is the architecture I designed and implemented.</p>
<p><img src="./micro-frontend-with-s3/micro-frontend-architecture.png" alt="Micro Frontend Architecture"></p>
<ul>
<li><code>Module-Federation</code> : This is core to implement micro-frontend architecture. This enables each applications to share modules at runtime. I used <a href="https://github.com/originjs/vite-plugin-federation" rel="nofollow" target="_blank">@originjs/vite-plugin-federation</a> for module federation.</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#282A36;color:#F8F8F2" tabindex="0" data-language="ts" data-theme="dracula"><code data-language="ts" data-theme="dracula" style="display: grid;"><span data-line=""><span style="color:#6272A4">// shell vite.config.ts</span></span>
<span data-line=""><span style="color:#FF79C6">import</span><span style="color:#F8F8F2"> federation </span><span style="color:#FF79C6">from</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">@originjs/vite-plugin-federation</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span data-line=""><span style="color:#FF79C6">import</span><span style="color:#F8F8F2"> react </span><span style="color:#FF79C6">from</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">@vitejs/plugin-react-swc</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span data-line=""><span style="color:#FF79C6">import</span><span style="color:#F8F8F2"> { defineConfig } </span><span style="color:#FF79C6">from</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">vite</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> CLOUDFRONT_DOMAIN </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">https://yourdomain.cloudfront.net</span><span style="color:#E9F284">'</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span style="color:#FF79C6">const</span><span style="color:#50FA7B"> getRemoteUrls</span><span style="color:#FF79C6"> =</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">mode</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> string</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=></span><span style="color:#F8F8F2"> {</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> isProd </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> mode </span><span style="color:#FF79C6">===</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">production</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">  </span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> {</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">    health</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> isProd </span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FF79C6">      ?</span><span style="color:#F1FA8C"> `</span><span style="color:#FF79C6">${</span><span style="color:#F8F8F2">CLOUDFRONT_DOMAIN</span><span style="color:#FF79C6">}</span><span style="color:#F1FA8C">/health/assets/remoteEntry.js`</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FF79C6">      :</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">http://localhost:3001/assets/remoteEntry.js</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">,</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">    insurance</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> isProd</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FF79C6">      ?</span><span style="color:#F1FA8C"> `</span><span style="color:#FF79C6">${</span><span style="color:#F8F8F2">CLOUDFRONT_DOMAIN</span><span style="color:#FF79C6">}</span><span style="color:#F1FA8C">/insurance/assets/remoteEntry.js`</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FF79C6">      :</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">http://localhost:3002/assets/remoteEntry.js</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">,</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">    mydata</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> isProd</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FF79C6">      ?</span><span style="color:#F1FA8C"> `</span><span style="color:#FF79C6">${</span><span style="color:#F8F8F2">CLOUDFRONT_DOMAIN</span><span style="color:#FF79C6">}</span><span style="color:#F1FA8C">/mydata/assets/remoteEntry.js`</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#FF79C6">      :</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">http://localhost:3003/assets/remoteEntry.js</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">,</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">  };</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">};</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FF79C6">export</span><span style="color:#FF79C6"> default</span><span style="color:#50FA7B"> defineConfig</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">async</span><span style="color:#F8F8F2"> ({ </span><span style="color:#FFB86C;font-style:italic">mode</span><span style="color:#F8F8F2"> }) </span><span style="color:#FF79C6">=></span><span style="color:#F8F8F2"> {</span></span>
<span data-line=""><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> {</span></span>
<span data-line=""><span style="color:#F8F8F2">    plugins</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> [</span></span>
<span data-line=""><span style="color:#50FA7B">      react</span><span style="color:#F8F8F2">(),</span></span>
<span data-line=""><span style="color:#50FA7B">      federation</span><span style="color:#F8F8F2">({</span></span>
<span data-line=""><span style="color:#F8F8F2">        name</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">shell</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">,</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">        remotes</span><span style="color:#FF79C6">:</span><span style="color:#50FA7B"> getRemoteUrls</span><span style="color:#F8F8F2">(mode),</span></span>
<span data-line=""><span style="color:#F8F8F2">        shared</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> [</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">react</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">, </span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">react-dom</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">, </span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">react-router-dom</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">],</span></span>
<span data-line=""><span style="color:#F8F8F2">      }),</span></span>
<span data-line=""><span style="color:#F8F8F2">    ],</span></span>
<span data-line=""><span style="color:#F8F8F2">    build</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span data-line=""><span style="color:#F8F8F2">      modulePreload</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">      target</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">esnext</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">      minify</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">      cssCodeSplit</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">    },</span></span>
<span data-line=""><span style="color:#F8F8F2">    server</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span data-line=""><span style="color:#F8F8F2">      port</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> 3000</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">      strictPort</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">    },</span></span>
<span data-line=""><span style="color:#F8F8F2">    preview</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span data-line=""><span style="color:#F8F8F2">      port</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> 3000</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">      strictPort</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span></span>
<span data-line=""><span style="color:#F8F8F2">    },</span></span>
<span data-line=""><span style="color:#F8F8F2">  }</span></span>
<span data-line=""><span style="color:#F8F8F2">})</span></span><button type="button" title="Copy code" aria-label="Copy code" data="// shell vite.config.ts
import federation from &#x27;@originjs/vite-plugin-federation&#x27;;
import react from &#x27;@vitejs/plugin-react-swc&#x27;;
import { defineConfig } from &#x27;vite&#x27;;

const CLOUDFRONT_DOMAIN = &#x27;https://yourdomain.cloudfront.net&#x27;

const getRemoteUrls = (mode: string) => {
  const isProd = mode === &#x27;production&#x27;;
  
  return {
    health: isProd 
      ? &#x60;${CLOUDFRONT_DOMAIN}/health/assets/remoteEntry.js&#x60;
      : &#x27;http://localhost:3001/assets/remoteEntry.js&#x27;,
    insurance: isProd
      ? &#x60;${CLOUDFRONT_DOMAIN}/insurance/assets/remoteEntry.js&#x60;
      : &#x27;http://localhost:3002/assets/remoteEntry.js&#x27;,
    mydata: isProd
      ? &#x60;${CLOUDFRONT_DOMAIN}/mydata/assets/remoteEntry.js&#x60;
      : &#x27;http://localhost:3003/assets/remoteEntry.js&#x27;,
  };
};

export default defineConfig(async ({ mode }) => {
  return {
    plugins: [
      react(),
      federation({
        name: &#x27;shell&#x27;,
        remotes: getRemoteUrls(mode),
        shared: [&#x27;react&#x27;, &#x27;react-dom&#x27;, &#x27;react-router-dom&#x27;],
      }),
    ],
    build: {
      modulePreload: true,
      target: &#x27;esnext&#x27;,
      minify: true,
      cssCodeSplit: true,
    },
    server: {
      port: 3000,
      strictPort: true,
    },
    preview: {
      port: 3000,
      strictPort: true
    },
  }
})" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#282A36;color:#F8F8F2" tabindex="0" data-language="ts" data-theme="dracula"><code data-language="ts" data-theme="dracula" style="display: grid;"><span data-line=""><span style="color:#6272A4">// micro-app vite.config.ts</span></span>
<span data-line=""><span style="color:#FF79C6">import</span><span style="color:#F8F8F2"> federation </span><span style="color:#FF79C6">from</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">@originjs/vite-plugin-federation</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span data-line=""><span style="color:#FF79C6">import</span><span style="color:#F8F8F2"> react </span><span style="color:#FF79C6">from</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">@vitejs/plugin-react-swc</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span data-line=""><span style="color:#FF79C6">import</span><span style="color:#F8F8F2"> { defineConfig } </span><span style="color:#FF79C6">from</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">vite</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FF79C6">export</span><span style="color:#FF79C6"> default</span><span style="color:#50FA7B"> defineConfig</span><span style="color:#F8F8F2">({</span></span>
<span data-line=""><span style="color:#F8F8F2">  plugins</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> [</span></span>
<span data-line=""><span style="color:#50FA7B">    react</span><span style="color:#F8F8F2">(),</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#50FA7B">    federation</span><span style="color:#F8F8F2">({</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">      name</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">health</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">,</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">      filename</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">remoteEntry.js</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">,</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">      exposes</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#E9F284">        '</span><span style="color:#F1FA8C">./App</span><span style="color:#E9F284">'</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">./src/App.tsx</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">,</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">      },</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">      shared</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> [</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">react</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">, </span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">react-dom</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">, </span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">react-router-dom</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">],</span></span>
<span data-line="" data-highlighted-line=""><span style="color:#F8F8F2">    }),</span></span>
<span data-line=""><span style="color:#F8F8F2">  ],</span></span>
<span data-line=""><span style="color:#F8F8F2">  build</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span data-line=""><span style="color:#F8F8F2">    modulePreload</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">    target</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">esnext</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">    minify</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">    cssCodeSplit</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">  },</span></span>
<span data-line=""><span style="color:#F8F8F2">  server</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span data-line=""><span style="color:#F8F8F2">    port</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> 3001</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">    strictPort</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">  },</span></span>
<span data-line=""><span style="color:#F8F8F2">  preview</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span data-line=""><span style="color:#F8F8F2">    port</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> 3001</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">    strictPort</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">  },</span></span>
<span data-line=""><span style="color:#F8F8F2">});</span></span><button type="button" title="Copy code" aria-label="Copy code" data="// micro-app vite.config.ts
import federation from &#x27;@originjs/vite-plugin-federation&#x27;;
import react from &#x27;@vitejs/plugin-react-swc&#x27;;
import { defineConfig } from &#x27;vite&#x27;;

export default defineConfig({
  plugins: [
    react(),
    federation({
      name: &#x27;health&#x27;,
      filename: &#x27;remoteEntry.js&#x27;,
      exposes: {
        &#x27;./App&#x27;: &#x27;./src/App.tsx&#x27;,
      },
      shared: [&#x27;react&#x27;, &#x27;react-dom&#x27;, &#x27;react-router-dom&#x27;],
    }),
  ],
  build: {
    modulePreload: true,
    target: &#x27;esnext&#x27;,
    minify: true,
    cssCodeSplit: true,
  },
  server: {
    port: 3001,
    strictPort: true,
  },
  preview: {
    port: 3001,
    strictPort: true,
  },
});" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>
<ul>
<li><code>S3</code> : This is a static web server for react app that is not supported SSR.</li>
</ul>
<p><img src="./micro-frontend-with-s3/s3.png" alt="S3"></p>
<ul>
<li><code>S3(cache bucket)</code> : This is a bucket to cache dependencies.</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#282A36;color:#F8F8F2" tabindex="0" data-language="yml" data-theme="dracula"><code data-language="yml" data-theme="dracula" style="display: grid;"><span data-line=""><span style="color:#6272A4"># buildspec.yml</span></span>
<span data-line=""><span style="color:#8BE9FD">cache</span><span style="color:#FF79C6">:</span></span>
<span data-line=""><span style="color:#8BE9FD">  paths</span><span style="color:#FF79C6">:</span></span>
<span data-line=""><span style="color:#FF79C6">    -</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">.pnpm-store/**/*</span><span style="color:#E9F284">'</span></span><button type="button" title="Copy code" aria-label="Copy code" data="# buildspec.yml
cache:
  paths:
    - &#x27;.pnpm-store/**/*&#x27;" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>
<p><img src="./micro-frontend-with-s3/cache-dependency.png" alt="cache-dependency"></p>
<p><img src="./micro-frontend-with-s3/s3-cache-bucket.png" alt="s3-cache-bucket"></p>
<ul>
<li><code>Cloudfront</code> : This is for static resources cache.</li>
<li><code>ECS(remote cache server)</code> : This is a critical key for remote caching on turborepo project. [ducktors/turborepo-remote-cache](https://github.com/ducktors/
turborepo-remote-cache)</li>
</ul>
<ul>
<li><code>cache hit</code>: The artifact was found in the cache → no build needed ❌</li>
<li><code>cache miss</code> : The artifact was not found in the cache → build triggered ✅</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#282A36;color:#F8F8F2" tabindex="0" data-language="yml" data-theme="dracula"><code data-language="yml" data-theme="dracula" style="display: grid;"><span data-line=""><span style="color:#6272A4"># buildspec.yml</span></span>
<span data-line=""><span style="color:#8BE9FD">pre_build</span><span style="color:#FF79C6">:</span></span>
<span data-line=""><span style="color:#8BE9FD">    commands</span><span style="color:#FF79C6">:</span></span>
<span data-line=""><span style="color:#FF79C6">      -</span><span style="color:#F1FA8C"> export TURBO_API=$TURBO_API</span></span>
<span data-line=""><span style="color:#FF79C6">      -</span><span style="color:#F1FA8C"> export TURBO_TEAM=$TURBO_TEAM</span></span>
<span data-line=""><span style="color:#FF79C6">      -</span><span style="color:#F1FA8C"> export TURBO_TOKEN=$TURBO_TOKEN</span></span>
<span data-line=""><span style="color:#FF79C6">      -</span><span style="color:#F1FA8C"> mkdir -p .turbo</span></span>
<span data-line=""><span style="color:#FF79C6">      -</span><span style="color:#FF79C6"> |</span></span>
<span data-line=""><span style="color:#F1FA8C">        echo "{</span></span>
<span data-line=""><span style="color:#F1FA8C">          \"apiurl\": \"$TURBO_API\",</span></span>
<span data-line=""><span style="color:#F1FA8C">          \"teamslug\": \"$TURBO_TEAM\",</span></span>
<span data-line=""><span style="color:#F1FA8C">          \"token\": \"$TURBO_TOKEN\"</span></span>
<span data-line=""><span style="color:#F1FA8C">        }" > .turbo/config.json</span></span>
<span data-line=""><span style="color:#FF79C6">      -</span><span style="color:#F1FA8C"> cat .turbo/config.json</span></span>
<span data-line=""><span style="color:#8BE9FD">cache</span><span style="color:#FF79C6">:</span></span>
<span data-line=""><span style="color:#8BE9FD">  paths</span><span style="color:#FF79C6">:</span></span>
<span data-line=""><span style="color:#FF79C6">    -</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">.turbo/**/*</span><span style="color:#E9F284">'</span></span><button type="button" title="Copy code" aria-label="Copy code" data="# buildspec.yml
pre_build:
    commands:
      - export TURBO_API=$TURBO_API
      - export TURBO_TEAM=$TURBO_TEAM
      - export TURBO_TOKEN=$TURBO_TOKEN
      - mkdir -p .turbo
      - |
        echo &#x22;{
          \&#x22;apiurl\&#x22;: \&#x22;$TURBO_API\&#x22;,
          \&#x22;teamslug\&#x22;: \&#x22;$TURBO_TEAM\&#x22;,
          \&#x22;token\&#x22;: \&#x22;$TURBO_TOKEN\&#x22;
        }&#x22; > .turbo/config.json
      - cat .turbo/config.json
cache:
  paths:
    - &#x27;.turbo/**/*&#x27;" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>
<p><img src="./micro-frontend-with-s3/cache-hit.png" alt="cache-hit"></p>
<h3>Issues and Solution</h3>
<ol>
<li>Bundle size issue</li>
</ol>
<p><img src="./micro-frontend-with-s3/bundle-size-issue.png" alt="cache-hit"></p>
<p>If a build artifact exceeds 500 KB, it’s not an absolute rule, but it’s considered a threshold where performance warnings may occur.
Vite uses Rollup internally, and by default, the <code>chunkSizeWarningLimit</code> is set to 500 KB.</p>
<p>So here is my solution.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#282A36;color:#F8F8F2" tabindex="0" data-language="ts" data-theme="dracula"><code data-language="ts" data-theme="dracula" style="display: grid;"><span data-line=""><span style="color:#6272A4">// vite.config.ts</span></span>
<span data-line=""><span style="color:#FF79C6">import</span><span style="color:#F8F8F2"> { visualizer } </span><span style="color:#FF79C6">from</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">rollup-plugin-visualizer</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FF79C6">export</span><span style="color:#FF79C6"> default</span><span style="color:#50FA7B"> defineConfig</span><span style="color:#F8F8F2">({</span></span>
<span data-line=""><span style="color:#F8F8F2">  plugins</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> [</span></span>
<span data-line=""><span style="color:#50FA7B">    visualizer</span><span style="color:#F8F8F2">({ open</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2"> })</span></span>
<span data-line=""><span style="color:#F8F8F2">  ],</span></span>
<span data-line=""><span style="color:#F8F8F2">  build</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span data-line=""><span style="color:#F8F8F2">    modulePreload</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">    target</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">esnext</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">    minify</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">    cssCodeSplit</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">  },</span></span>
<span data-line=""><span style="color:#F8F8F2">});</span></span><button type="button" title="Copy code" aria-label="Copy code" data="// vite.config.ts
import { visualizer } from &#x22;rollup-plugin-visualizer&#x22;;

export default defineConfig({
  plugins: [
    visualizer({ open: true })
  ],
  build: {
    modulePreload: true,
    target: &#x27;esnext&#x27;,
    minify: true,
    cssCodeSplit: true,
  },
});" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#282A36;color:#F8F8F2" tabindex="0" data-language="sh" data-theme="dracula"><code data-language="sh" data-theme="dracula" style="display: grid;"><span data-line=""><span style="color:#50FA7B">$</span><span style="color:#F1FA8C"> pnpm</span><span style="color:#BD93F9"> --filter</span><span style="color:#F8F8F2"> [PROJECT_FOLDER_NAME] build:dev</span></span><button type="button" title="Copy code" aria-label="Copy code" data="$ pnpm --filter [PROJECT_FOLDER_NAME] build:dev" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>
<p><img src="./micro-frontend-with-s3/rollup-plugin-visualizer.png" alt="rollup-plugin-visualizer"></p>
<p>The problematic file right now is <code>__federation_expose_AppApp-DeQt32zZ.js</code>, which bundles Datadog, Braze, Sentry, and other libraries together.</p>
<p>I tried to try performing <code>code splitting</code> using <code>manual chucnk</code>.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#282A36;color:#F8F8F2" tabindex="0" data-language="ts" data-theme="dracula"><code data-language="ts" data-theme="dracula" style="display: grid;"><span data-line=""><span style="color:#6272A4">// vite.config.ts</span></span>
<span data-line=""><span style="color:#F8F8F2">build: {</span></span>
<span data-line=""><span style="color:#F8F8F2">  modulePreload: </span><span style="color:#BD93F9">true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">  target: </span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">esnext</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">  minify: </span><span style="color:#BD93F9">true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">  cssCodeSplit: </span><span style="color:#BD93F9">true</span><span style="color:#F8F8F2">,</span></span>
<span data-line=""><span style="color:#F8F8F2">  rollupOptions: {</span></span>
<span data-line=""><span style="color:#F8F8F2">    output: {</span></span>
<span data-line=""><span style="color:#50FA7B">      manualChunks</span><span style="color:#F8F8F2">(id) {</span></span>
<span data-line=""><span style="color:#FF79C6">        if</span><span style="color:#F8F8F2"> (id.</span><span style="color:#50FA7B">includes</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">node_modules</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">)) {</span></span>
<span data-line=""><span style="color:#FF79C6">          if</span><span style="color:#F8F8F2"> (id.</span><span style="color:#50FA7B">includes</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">@sentry</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">)) </span><span style="color:#FF79C6">return</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">vendor-sentry</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span data-line=""><span style="color:#FF79C6">          if</span><span style="color:#F8F8F2"> (id.</span><span style="color:#50FA7B">includes</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">@datadog</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">)) </span><span style="color:#FF79C6">return</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">vendor-datadog</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span data-line=""><span style="color:#FF79C6">          if</span><span style="color:#F8F8F2"> (id.</span><span style="color:#50FA7B">includes</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">@braze</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">)) </span><span style="color:#FF79C6">return</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">vendor-braze</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span data-line=""><span style="color:#F8F8F2">        }</span></span>
<span data-line=""><span style="color:#F8F8F2">      }</span></span>
<span data-line=""><span style="color:#F8F8F2">    },</span></span>
<span data-line=""><span style="color:#F8F8F2">  }</span></span>
<span data-line=""><span style="color:#F8F8F2">},</span></span><button type="button" title="Copy code" aria-label="Copy code" data="// vite.config.ts
build: {
  modulePreload: true,
  target: &#x27;esnext&#x27;,
  minify: true,
  cssCodeSplit: true,
  rollupOptions: {
    output: {
      manualChunks(id) {
        if (id.includes(&#x27;node_modules&#x27;)) {
          if (id.includes(&#x27;@sentry&#x27;)) return &#x27;vendor-sentry&#x27;;
          if (id.includes(&#x27;@datadog&#x27;)) return &#x27;vendor-datadog&#x27;;
          if (id.includes(&#x27;@braze&#x27;)) return &#x27;vendor-braze&#x27;;
        }
      }
    },
  }
}," class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>
<p><img src="./micro-frontend-with-s3/manual-chunk.png" alt="manual-chunk"></p>
<p><em><strong>827.55 kB → 348.93 kB</strong></em> BOOM!</p>
<ol start="2">
<li>Memory issue on Codebuild</li>
</ol>
<p><code>counsel:build:dev: Error: write EPIPE</code></p>
<p>The error above occurs due to insufficient memory during the build. This project is a monorepo managed with Turborepo and contains multiple domain applications, which can lead to high memory usage and cause this issue. We need to improve the compute performance.</p>
<p><img src="./micro-frontend-with-s3/codebuild-compute.png" alt="codebuild-compute"></p>
<h2>Wrap Up</h2>
<p>While designing the micro-frontend project, I gained a much deeper understanding of the concept of microservices. On top of that, I had the opportunity to handle everything from A to Z — including infrastructure — which significantly expanded the scope of my work. It turned out to be a really meaningful experience.</p>2:[["$","$Le",null,{"children":[["$","$Lb",null,{"order":2,"fw":900,"size":"h1","children":"Micro-Frontend-With-S3"}],["$","$Lc",null,{"size":"sm","c":"dimmed","children":"Sat, Nov 29,  2025"}]]}],["$","$Lf",null,{"className":"markdown","children":["$","div",null,{"className":"markdown","dangerouslySetInnerHTML":{"__html":"$10"}}]}],["$","$L11",null,{}]]
